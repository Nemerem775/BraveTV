<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Admin - Anonymous Messages</title>
<style>
:root{
  --bg: #0b1220;
  --accent: #7c5cff;
  --accent2: #4ab6ff;
  --text: #e6eef8;
  --card-bg: rgba(255,255,255,0.05);
}

*{box-sizing:border-box;margin:0;padding:0;font-family:Inter,sans-serif;}
body{
  background: var(--bg);
  color: var(--text);
  min-height:100vh;
  padding:20px;
}

h1{
  text-align:center;
  margin-bottom:20px;
  color:var(--accent);
}

#messages{
  display:flex;
  flex-direction:column;
  gap:12px;
  max-width:600px;
  margin:0 auto;
}

.message-card{
  background: var(--card-bg);
  padding:12px 16px;
  border-radius:12px;
  backdrop-filter: blur(6px);
  box-shadow: 0 4px 15px rgba(0,0,0,0.3);
  word-wrap: break-word;
  opacity: 1;
  transition: background 0.4s, transform 0.4s;
}

.message-card.new{
  background: #7c5cff44;
  transform: scale(1.03);
  animation:flash 1s ease forwards;
}

@keyframes flash{
  0%{background: #7c5cff44; transform: scale(1.03);}
  50%{background: var(--card-bg); transform: scale(1);}
  100%{background: var(--card-bg); transform: scale(1);}
}

.message-card time{
  display:block;
  font-size:12px;
  color:#a6b0c3;
  margin-bottom:6px;
}
</style>
</head>
<body>

<h1>Anonymous Messages</h1>
<div id="messages">Loading messages...</div>

<script>
// Replace with your Apps Script URL
const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzPBQUGrvokbmO9N1zD5zwW6567D0nUddav8dvD-CPXP3ycspG1S7inCoewVZHrb4tAYw/exec';

let latestTimestamp = 0;

async function fetchMessages(){
  try{
    const res = await fetch(APPS_SCRIPT_URL);
    const data = await res.json();
    const container = document.getElementById('messages');
    
    if(!Array.isArray(data) || data.length === 0){
      container.innerHTML = '<p>No messages yet.</p>';
      return;
    }

    container.innerHTML = '';
    data.forEach(msg=>{
      const card = document.createElement('div');
      card.className = 'message-card';
      
      const msgTime = new Date(msg.time).getTime();

      // Highlight new messages
      if(msgTime > latestTimestamp){
        card.classList.add('new');
      }

      const timeElem = document.createElement('time');
      timeElem.textContent = new Date(msg.time).toLocaleString();

      const content = document.createElement('div');
      content.textContent = msg.message;

      card.appendChild(timeElem);
      card.appendChild(content);
      container.appendChild(card);

      // Update latest timestamp
      if(msgTime > latestTimestamp) latestTimestamp = msgTime;
    });
  }catch(err){
    console.error(err);
    document.getElementById('messages').innerHTML = '<p>Error loading messages.</p>';
  }
}

// Initial fetch
fetchMessages();

// Refresh every 10 seconds and highlight new messages
setInterval(fetchMessages, 10000);
</script>

</body>
</html>
